<!DOCTYPE html>
<html>
<head>
    <script defer src="https://unpkg.com/alpinejs@3.5.0/dist/cdn.min.js"></script>
</head>
<body>
<div x-data="{
    movie: null,
    getMovies() {
        fetch('https://fastapi-samir-elha.cloud.okteto.net/genre')
            .then((response) => response.json())
            .then((json) => this.movie = json);
    }
}" x-init="getMovies()">
    <p x-text="movie.data[0].genre"></p>
    <p x-text="movie.data[0].movies"></p>
    <p x-text="movie.data[1].genre"></p>
    <p x-text="movie.data[1].movies"></p>
</div>

<div class="flex flex-col h-screen justify-center content-center">
  <div class="flex flex-col self-center px-8 pt-6 pb-8 max-w-7xl my-2 mb-4 bg-white rounded shadow-md" x-data="{genre : {
                        genre: null,
                        movie: null
                        }}" x-init="(async () => {
                                  const response = await fetch('https://fastapi-samir-elha.cloud.okteto.net/genre')
                                  if (! response.ok) alert(`Something went wrong: ${response.status} - ${response.statusText}`)
                                  data = await response.json()
                                  genre = {
                                             genre: data.name,
                                             movie: data.movies
                                             }
                                             })()">
    <div class="mb-6 md:flex">
      <div class="px-3 mb-6 md:w-1/2 md:mb-0">
        <label class="block mb-2 text-xs font-bold tracking-wide uppercase text-grey-darker" for="name">
          Name
        </label>
        <input x-model="genre.name" class="block w-full px-4 py-3 mb-3 border rounded appearance-none bg-grey-lighter text-grey-darker border-red" required type="text" id="name">
      </div>
      <div class="px-3 md:w-1/2">
        <label class="block mb-2 text-xs font-bold tracking-wide uppercase text-grey-darker" for="movies">
          email
        </label>
        <input x-model="genre.movies" class="block w-full px-4 py-3 border rounded appearance-none bg-grey-lighter text-grey-darker border-grey-lighter" required type="text" id="movies">
      </div>
    </div>
    </div>
    <div class="mb-2  md:flex flex justify-end">
      <button @click="(async () => {
                                    const response = await fetch('https://fastapi-samir-elha.cloud.okteto.net/genre', {
                                        method: 'POST',
                                        body: JSON.stringify(genre)
                                    })
                                    if (response.ok) alert('Updated Successfully!')
                                    else alert(`Something went wrong: ${response.status} - ${response.statusText}`)
                                })()" class="inline-block px-6 py-2 text-xs font-medium leading-6 text-center text-white uppercase transition bg-blue-700 rounded shadow ripple hover:shadow-lg hover:bg-blue-800 focus:outline-none">
        Update Info
      </button>

    </div>
  </div>
</div>

<script>
    function getMovies() {
    fetch('https://fastapi-samir-elha.cloud.okteto.net/genre')
        .then((response) => response.json())
        .then((json) => this.movie = json);
    }
</script>
</body>
</html>